<%= link_to "<- Back to All Buses", buses_path %>
<h1><%= @bus.bus_owner.name %></h1>
<h3><%= @bus.source %> to <%= @bus.destination %></h3>
<p>Bus Number: <%= @bus.bus_number %></p>
<p>Date: <%= formatted_date(@bus.journey_date) %>, <%= formatted_time(@bus.depart_time) %></p>
<p>Status: <%= @bus.approved? ? "Approved" : "Not Approved"%>
</p>
<% if available_seats(@bus)<=0 %>
  <button class="btn btn-primary">Sold Out</button>
<% else %>
  <p>Seats: <%= available_seats(@bus) %> Available</p>
  <%= link_to "Book Now", new_bus_reservation_path(@bus), class: "btn btn-primary" %>
<% end %>
<% if user_signed_in? %>
  <%# <% if @bus.bus_owner.id == current_user.id %>
  <% if policy(@bus).edit? %>
    <%= link_to "Edit Bus", edit_bus_path, class: "btn btn-primary" %>
    <%= button_to "Cancel Bus", bus_path(@bus), method: :delete, class: "btn btn-primary" %>
    <section class="user">
      <% if @reservations.present? %>
        <h3>Reservations</h3>
        <% @reservations.each do |ticket| %>
          <% if ticket.bus.journey_date > Time.now %>
            <div class="review">
              <div class="details">
                <span class="title">
                  <%= ticket.user.name %>
                </span>
                <br>
                <p>
                  Number of Seats: <%= ticket.seats %>
                </p>
              </div>
              <%= button_to "Cancel Reservation", user_reservation_path(current_user,ticket), method: :delete, class: "btn btn-primary" %>
            </div>
          <% end %>
        <% end %>
      <% else %>
        <h3>No Reservations for this bus yet.</h3>
      <% end %>
    </section>
  <% end %>
<% end %>
